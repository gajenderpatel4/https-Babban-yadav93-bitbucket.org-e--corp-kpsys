<div ng-controller="SearchCtrl">
    <div class="row">
        <form name="searchForm" novalidate data-ng-init="init()">
            <div class="portlet col-md-5">
                <h3>License Plate Search</h3>
                <div class="form-group">
                    <div class="required-field-block">
                        <input class="form-control" type="text" id="licensePlate" name="q" ng-model="query" placeholder="License Plate" >
                        <div class="required-icon" data-original-title="" title="">
                            <div class="text">*</div>
                        </div>
                    </div>
                </div>
                <div class="form-group" ng-if="submitted && query.length == 0">
                    <span class="text-danger">License Plate required</span>
                </div>
                <div class="form-group" ng-if="submitted && responseError">
                    <span class="text-danger">{{responseError}}</span>
                </div>
                <button type="submit" class="btn btn-default" ng-click="searchForm.$valid && submit(q)">Find</button>
            </div>
        </form>
    </div>
    <div ng-if="loading" class="row loading-message">
        <div  class="page-spinner-bar">
            <div class="bounce1"></div>
            <div class="bounce2"></div>
            <div class="bounce3"></div>
        </div>
    </div>
    <div ng-show='submitted && licensePlates.length == 0' class="row">
        We could not find any results for {{query}}.
    </div>
    <div class="form-group" ng-if="paypalResponseError">
        <span class="text-danger">{{paypalResponseError}}</span>
    </div>

    <div ng-show='submitted && licensePlates.length > 0' class="row">
        <table class="table" id="license-plates-tbl">
            <thead>
                <tr>
                    <th>License Plate</th>
                    <th>Currency</th>
                    <th>Due Amount</th>
                    <th>ParkingId</th>
                    <th>Description</th>
                    <th>Start Timestamp</th>
                    <th>End Timestamp</th>
                    <th></th>
                </tr>
            </thead>
            <tbody>
                <tr ng-repeat="lp in licensePlates"
                    ng-class="{'danger': checkErrorStatus($index) == true } ">
                    <td>{{lp.licensePlate}}</td>
                    <td>{{lp.currency}}</td>
                    <td>{{lp.dueAmount}}</td>
                    <td>{{lp.parkingId}}</td>
                    <td>{{lp.description}}</td>
                    <td>{{lp.startTimestamp}}</td>
                    <td>{{lp.endTimestamp}}</td>
                    <td><button type='button' class="btn btn-default" ng-click='pay($index)'>Make payment</button></td>
                </tr>
            </tbody>
        </table>
    </div>
</div>
